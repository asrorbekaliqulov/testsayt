{% extends 'admin/base_admin.html' %}

{% block title %}{% if test_block %}Tahrirlash{% else %}Yangi Test Bloki{% endif %} | Admin Panel{% endblock %}

{% block content %}
<div class="content-header">
    <h1>
        <i class="fas fa-clipboard-list"></i> 
        {% if test_block %}Test Blokini Tahrirlash{% else %}Yangi Test Bloki{% endif %}
    </h1>
    <a href="{% url 'admin_test_blocks' %}" class="btn btn-secondary">
        <i class="fas fa-arrow-left"></i> Orqaga
    </a>
</div>

{% if messages %}
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
        {{ message }}
    </div>
    {% endfor %}
{% endif %}

<div class="card">
    <div class="card-body">
        <form method="post">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="title">Test nomi *</label>
                <input type="text" id="title" name="title" class="form-control" 
                       value="{% if test_block %}{{ test_block.title }}{% endif %}" required>
            </div>

            <div class="form-group">
                <label for="description">Tavsif</label>
                <textarea id="description" name="description" class="form-control" rows="3">{% if test_block %}{{ test_block.description }}{% endif %}</textarea>
            </div>

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="course">Kurs *</label>
                    <select id="course" name="course" class="form-control" required>
                        <option value="">Tanlang...</option>
                        {% for course in courses %}
                        <option value="{{ course.id }}" {% if test_block and test_block.course.id == course.id %}selected{% endif %}>
                            {{ course.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                <div class="form-group col-md-6">
                    <label for="time_per_question">Har bir savol uchun vaqt (daqiqa) *</label>
                    <input type="number" id="time_per_question" name="time_per_question" class="form-control" 
                           value="{% if test_block %}{{ test_block.time_per_question }}{% else %}2{% endif %}" 
                           min="1" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="start_time">Boshlanish vaqti *</label>
                    <input type="datetime-local" id="start_time" name="start_time" class="form-control" 
                           value="{% if test_block %}{{ start_time_formatted }}{% endif %}" required>
                </div>

                {% if test_block %}
                <div class="form-group col-md-6">
                    <label>&nbsp;</label>
                    <div class="form-check" style="padding-top: 10px;">
                        <input type="checkbox" id="is_active" name="is_active" class="form-check-input" 
                               {% if test_block.is_active %}checked{% endif %}>
                        <label for="is_active" class="form-check-label">
                            Faol holat
                        </label>
                    </div>
                </div>
                {% endif %}
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Saqlash
                </button>
                <a href="{% url 'admin_test_blocks' %}" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Bekor qilish
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
